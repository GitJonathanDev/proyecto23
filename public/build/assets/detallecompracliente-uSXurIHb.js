import{p as b}from"./plantillanavcliente-RjW_wxKy.js";import{d as v}from"./index-Db_33LEY.js";import{s as f,e as r,b as h,a as t,F as g,h as y,t as l,i as _,k as m,v as x,z as u,o as n,g as w}from"./app-C6Ljm75g.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";const k={components:{plantillanavcliente:b},data(){return{productos:this.$page.props.productos.map(s=>({...s,cantidad:this.$page.props.cantidades[s.codProducto]||1})),tipoServicio:"1",telefono:"123456789"}},computed:{totalCarrito(){return this.productos.reduce((s,e)=>s+e.precio*e.cantidad,0).toFixed(2)}},methods:{validarCantidad(s){const e=this.productos[s];e.cantidad>e.stock&&(e.cantidad=e.stock,this.mostrarAlerta("La cantidad no puede ser mayor que el stock disponible."))},eliminarProducto(s){this.productos.splice(s,1),this.productos.length===0&&this.redirigirVistaCliente()},redirigirVistaCliente(){v.Inertia.visit(route("vista-cliente"))},mostrarAlerta(s){alert(s)},realizarPago(){alert("Iniciar pago")},confirmarCompra(){axios.post("/venta/create",{productos:this.productos,tnMonto:parseFloat(this.totalCarrito)}).then(s=>{s.data.redirect?window.location.href=s.data.redirect:alert(s.data.success||"Compra realizada con éxito.")}).catch(s=>{console.error(s),alert("Hubo un error al registrar la compra.")})},volver(){this.$router.push({name:"cliente"})}}},S={class:"container mt-5"},V={class:"card mb-4"},I={class:"table-responsive"},P={class:"table table-bordered table-striped"},N=["src"],T={key:1},z=["onUpdate:modelValue","max","onInput"],B=["onClick"],F={class:"container mt-4 d-flex justify-content-end"},M={class:"card p-3 shadow-sm",style:{"max-width":"300px",width:"100%"}},j={class:"d-flex justify-content-between align-items-center"},A={class:"font-weight-bold ml-3"},U={class:"row mb-4"},L={class:"col-md-4 mb-4"},Q={class:"card h-100"},q={class:"card-body"},D={class:"form-group"},R={class:"form-group"},E={class:"d-flex justify-content-end mt-4"},H={class:"d-flex justify-content-center mb-4"},O=["disabled"];function G(s,e,J,K,a,i){const p=f("plantillanavcliente");return n(),r("div",null,[h(p,{userName:s.$page.props.auth.user.name},null,8,["userName"]),t("main",S,[t("div",V,[e[7]||(e[7]=t("h1",{class:"text-center mb-4"},"Lista de tus productos que comprarás",-1)),t("div",I,[t("table",P,[e[6]||(e[6]=t("thead",null,[t("tr",null,[t("th",{class:"font-weight-bold"},"Imagen"),t("th",{class:"font-weight-bold"},"Producto"),t("th",{class:"font-weight-bold"},"Cantidad"),t("th",{class:"font-weight-bold"},"Precio Unitario"),t("th",{class:"font-weight-bold"},"Total"),t("th",{class:"font-weight-bold"},"Acciones")])],-1)),t("tbody",null,[(n(!0),r(g,null,y(a.productos,(o,d)=>(n(),r("tr",{class:"fila",key:d},[t("td",null,[o.imagen_url?(n(),r("img",{key:0,src:`/storage/uploads/${o.imagen_url}`,alt:"Imagen del producto",class:"img-thumbnail",style:{"max-width":"120px"}},null,8,N)):(n(),r("span",T,"No tiene imagen"))]),t("td",null,l(o.nombre),1),t("td",null,[m(t("input",{type:"number","onUpdate:modelValue":c=>o.cantidad=c,class:"form-control form-control-sm cantidad-input",min:1,max:o.stock,onInput:c=>i.validarCantidad(d)},null,40,z),[[u,o.cantidad,void 0,{number:!0}]])]),t("td",null,"Bs. "+l(o.precio.toFixed(2)),1),t("td",null,[e[5]||(e[5]=w("Bs. ")),t("span",null,l((o.precio*o.cantidad).toFixed(2)),1)]),t("td",null,[t("button",{onClick:c=>i.eliminarProducto(d),class:"btn btn-primary btn-sm"},"Quitar",8,B)])]))),128))])])])]),t("div",F,[t("div",M,[t("div",j,[e[8]||(e[8]=t("div",{class:"font-weight-bold"},"TOTAL:",-1)),t("div",A,l(i.totalCarrito)+" Bs.",1)])])]),t("div",U,[t("div",L,[t("div",Q,[t("div",q,[e[13]||(e[13]=t("h1",{class:"text-center mb-4"},"Realizar pago",-1)),t("form",{onSubmit:e[3]||(e[3]=_((...o)=>i.realizarPago&&i.realizarPago(...o),["prevent"]))},[t("div",D,[e[10]||(e[10]=t("label",{for:"tipoServicio"},"Tipo de Servicio",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>a.tipoServicio=o),id:"tipoServicio",class:"form-control ml-4",required:""},e[9]||(e[9]=[t("option",{value:"1"},"Servicio QR",-1),t("option",{value:"2"},"Tigo Money",-1)]),512),[[x,a.tipoServicio]])]),t("div",R,[e[11]||(e[11]=t("label",{for:"telefono"},"Número de cuenta",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>a.telefono=o),id:"telefono",class:"form-control ml-4",readonly:""},null,512),[[u,a.telefono]])]),t("div",E,[t("button",{type:"button",class:"btn btn-secondary mr-2",onClick:e[2]||(e[2]=(...o)=>i.volver&&i.volver(...o))},"Atrás"),e[12]||(e[12]=t("button",{type:"submit",class:"btn btn-primary"},"Mostrar Qr",-1))])],32)])])]),e[14]||(e[14]=t("div",{class:"col-md-6"},[t("div",{class:"d-flex justify-content-center align-items-center h-100"},[t("iframe",{name:"QrImage",class:"w-100",style:{height:"400px",border:"1px solid #ddd"}})])],-1))]),t("div",H,[t("button",{type:"button",onClick:e[4]||(e[4]=(...o)=>i.confirmarCompra&&i.confirmarCompra(...o)),class:"btn btn-primary",disabled:a.productos.length===0}," Comprar ",8,O)])])])}const $=C(k,[["render",G],["__scopeId","data-v-dc996c2c"]]);export{$ as default};
